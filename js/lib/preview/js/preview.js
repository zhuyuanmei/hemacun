define(function(){var i=$(window),t=($(document),1),s=!-[1]&&!window.XMLHttpRequest,e=!1,n=function(i){this.settings=$.extend({},n.defaults,i),this.init()};n.prototype={init:function(){this.create(),this.settings.lock&&this.lock(),this.settings.time&&this.time()},create:function(){var s="";s=this.settings.setHeader?'<div class="rDialog-wrap"><a href="javascript:;" class="rDialog-close" title="关闭">x</a><div class="rDialog-header">'+this.settings.title+'</div><div class="rDialog-content">'+this.settings.content+'</div><div class="rDialog-footer"></div></div>':'<div class="rDialog-wrap"><div class="rDialog-content">'+this.settings.content+'</div><div class="rDialog-footer"></div></div>',this.preview=$("<div>").addClass("rDialog").css({zIndex:this.settings.zIndex+t++}).html(s),this.preview.prependTo("body"),$(".rDialog-header").length&&this.settings.headerBackground&&$(".rDialog-header").css("backgroundColor",this.settings.headerBackground),$.isFunction(this.settings.ok)&&""!==this.settings.okText&&this.ok(),$.isFunction(this.settings.cancel)&&""!==this.settings.cancelText&&this.cancel(),this.size(),this.position(),this.bindEvent(),""!==this.settings.background&&($(".rDialog").css("top",5),i.on("resize",function(){$(".rDialog").css("top",5)}),$(".rDialog-wrap").css({background:"none",border:"none"}))},ok:function(){var i=this,t=this.preview.find(".rDialog-footer")[0],s=$('<a href="javascript:;" class="rDialog-ok">'+this.settings.okText+"</a>");s.prependTo(t),this.settings.okSize&&s.css({width:"80%",background:"#a4269e"}),s.on("click",function(){i.settings.okCallBack?i.settings.ok():i.close()})},cancel:function(){var i=this,t=this.preview.find(".rDialog-footer")[0],s=$('<a href="javascript:;" class="rDialog-cancel">'+this.settings.cancelText+"</a>");s.prependTo(t),s.on("click",function(){i.close()})},size:function(){var i=this.preview.find(".rDialog-content"),t=this.preview.find(".rDialog-wrap");i.css({width:this.settings.width,height:this.settings.height}),t.css("width",i.width())},position:function(){var t=this,s=i.width(),e=i.height(),n=0;this.preview.css({left:(s-t.preview.width())/2,top:(e-t.preview.height())/2+n})},lock:function(){e||(this.lock=$("<div>").css({zIndex:this.settings.zIndex}).addClass("rDialog-mask"),this.lock.appendTo("body"),s&&(this.lock.css({height:$("body").height()}),this.lock.html('<iframe style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;border:0 none;filter:alpha(opacity=0)"></iframe>')),e=!0)},unLock:function(){this.settings.lock&&e&&(this.lock.remove(),e=!1)},close:function(){this.preview.remove(),this.unLock()},time:function(){var i=this;this.closeTimer=setTimeout(function(){i.close()},this.settings.time)},bindEvent:function(){var t=this,e=this.preview.find(".rDialog-close");e.on("click",function(){t.close()}),i.on("resize",function(){t.position()}),s&&i.on("scroll",function(){t.position()})}},n.defaults={content:"请稍等...",title:"提示",width:"auto",height:"auto",ok:function(){},cancel:function(){},okText:"",okCallBack:!1,okSize:!1,cancelText:"",time:null,lock:!1,isDrag:!0,zIndex:9,background:"",setHeader:!0,headerBackground:""};var o=function(i){new n(i)};window.rPreview=$.rPreview=$.preview=o});